<!DOCTYPE html>
<html lang="zh">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width,initial-scale=1.0">
  <title>æ•™ç»ƒç«¯ - æˆ‘çš„è¯¾è¡¨</title>
  <style>
    body { margin:0; font-family:"Segoe UI","PingFang SC",sans-serif; background:#f0f2f5; display:flex; min-height:100vh; }
    .sidebar { width:240px; background:linear-gradient(180deg,#4facfe,#0056b3); color:#fff; padding:20px 0; }
    .sidebar h2 { text-align:center; margin-bottom:2rem; font-weight:600; }
    .sidebar a { color:#fff; padding:12px 20px; display:block; text-decoration:none; margin:6px 15px; border-radius:8px; }
    .sidebar a:hover { background:rgba(255,255,255,0.2); }
    .main { flex:1; display:flex; flex-direction:column; }
    .topbar { height:60px; background:#fff; display:flex; align-items:center; justify-content:space-between; padding:0 24px; border-bottom:1px solid #ddd; }
    .content { padding:30px; }
    .card { background:#fff; border-radius:12px; padding:20px; box-shadow:0 4px 12px rgba(0,0,0,0.05); }
    h3 { margin:0 0 16px; color:#333; }
    .filter { margin-bottom:20px; }
    input[type=date] { padding:6px 10px; border:1px solid #ddd; border-radius:6px; }
    button { padding:8px 14px; border:none; border-radius:6px; cursor:pointer; }
    .btn-primary { background:#4facfe; color:#fff; }
    .btn-primary:hover { opacity:0.9; }
    table { width:100%; border-collapse:collapse; margin-top:12px; }
    th,td { padding:10px; text-align:center; border-bottom:1px solid #eee; }
    th { background:#f9fafc; color:#333; font-weight:600; }
    tr:hover { background:#f6fbff; }
    .status { padding:4px 8px; border-radius:6px; font-size:12px; }
    .status.confirmed { background:#e6ffed; color:#2e7d32; }
    .status.pending { background:#fff3cd; color:#856404; }
    .status.rejected, .status.cancelled { background:#fdecea; color:#c62828; }
  </style>
</head>
<body>
  <!-- å·¦ä¾§å¯¼èˆª -->
  <div class="sidebar">
    <h2>æ•™ç»ƒç«¯</h2>
    <a href="/coach-dashboard">ğŸ  é¦–é¡µ</a>
    <a href="/coach/appointments">ğŸ“… è¯¾ç¨‹ç®¡ç†</a>
    <a href="/coach/students">ğŸ‘¨â€ğŸ“ å­¦ç”Ÿç®¡ç†</a>
    <a href="/coach/availability">â° æ—¶é—´è®¾ç½®</a>
    <a href="/coach/evaluations">ğŸ“ è®­ç»ƒè¯„ä»·</a>
    <a href="/coach/schedule">ğŸ“Š æˆ‘çš„è¯¾è¡¨</a>
    <a href="/coach/messages">ğŸ“© ç³»ç»Ÿæ¶ˆæ¯</a>
    <a href="/coach/profile">âš™ï¸ ä¸ªäººè®¾ç½®</a>
  </div>

  <!-- ä¸»ä½“ -->
  <div class="main">
    <div class="topbar">
      <h3>æˆ‘çš„è¯¾è¡¨</h3>
      <button class="btn-primary" onclick="logout()">é€€å‡ºç™»å½•</button>
    </div>
    <div class="content">
      <div class="card">
        <div class="filter">
          <label>èµ·å§‹æ—¥æœŸï¼š</label>
          <input type="date" id="startDate">
          <label>ç»“æŸæ—¥æœŸï¼š</label>
          <input type="date" id="endDate">
          <button class="btn-primary" onclick="loadSchedule()">æŸ¥è¯¢</button>
        </div>
        <table>
          <thead>
            <tr>
              <th>å­¦ç”Ÿå§“å</th>
              <th>è”ç³»æ–¹å¼</th>
              <th>å¼€å§‹æ—¶é—´</th>
              <th>ç»“æŸæ—¶é—´</th>
              <th>çƒå°</th>
              <th>çŠ¶æ€</th>
            </tr>
          </thead>
          <tbody id="scheduleBody">
            <tr><td colspan="6">è¯·å…ˆé€‰æ‹©æ—¶é—´èŒƒå›´å¹¶ç‚¹å‡»æŸ¥è¯¢</td></tr>
          </tbody>
        </table>
      </div>
    </div>
  </div>

<script>
  function logout(){ window.location.href='/logout'; }

  async function loadSchedule(){
    const start=document.getElementById("startDate").value;
    const end=document.getElementById("endDate").value;
    if(!start||!end){alert("è¯·é€‰æ‹©èµ·æ­¢æ—¥æœŸ");return;}
    const res=await fetch(`/api/coach/schedule?start=${start}&end=${end}`);
    const data=await res.json();
    const body=document.getElementById("scheduleBody");
    body.innerHTML="";
    if(!data.length){body.innerHTML=`<tr><td colspan="6">è¯¥æ—¶é—´æ®µæ²¡æœ‰è¯¾ç¨‹</td></tr>`;return;}
    data.forEach(item=>{
      const tr=document.createElement("tr");
      tr.innerHTML=`
        <td>${item.student_name||'-'}</td>
        <td>${item.student_phone||'-'}</td>
        <td>${item.start_time}</td>
        <td>${item.end_time}</td>
        <td>${item.table_number||'æœªåˆ†é…'}</td>
        <td><span class="status ${item.status}">${item.status}</span></td>`;
      body.appendChild(tr);
    });
  }
</script>
</body>
</html>
